<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fact-It Settings</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Fact-It</h1>
        <p class="subtitle">Real-time fact-checking extension</p>
      </header>

      <main>
        <section class="status">
          <div class="status-indicator" id="status-indicator">
            <span class="status-dot"></span>
            <span class="status-text" id="status-text">Checking status...</span>
          </div>
        </section>

        <section class="settings">
          <h2>AI Providers</h2>
          <p class="help-text">Configure one or more AI providers for fact-checking. Multiple providers will run in parallel for cross-verification.</p>

          <!-- OpenAI Provider -->
          <div class="provider-section">
            <div class="provider-header">
              <label class="provider-toggle">
                <input type="checkbox" id="openai-enabled" class="provider-checkbox" />
                <span class="provider-name">OpenAI</span>
              </label>
              <span class="config-status" id="openai-status"></span>
            </div>
            <div class="provider-config" id="openai-config">
              <div class="form-group">
                <label for="openai-api-key">
                  API Key
                  <span class="optional">(GPT-4o with built-in web search)</span>
                </label>
                <div class="input-with-button">
                  <input
                    type="password"
                    id="openai-api-key"
                    placeholder="sk-..."
                    autocomplete="off"
                  />
                  <button class="btn-test" id="test-openai">Test</button>
                </div>
                <small class="help-text">
                  Get your API key from
                  <a href="https://platform.openai.com/api-keys" target="_blank">
                    platform.openai.com
                  </a>
                </small>
              </div>
            </div>
          </div>

          <!-- Anthropic Provider -->
          <div class="provider-section">
            <div class="provider-header">
              <label class="provider-toggle">
                <input type="checkbox" id="anthropic-enabled" class="provider-checkbox" />
                <span class="provider-name">Anthropic</span>
              </label>
              <span class="config-status" id="anthropic-status"></span>
            </div>
            <div class="provider-config" id="anthropic-config">
              <div class="form-group">
                <label for="anthropic-api-key">
                  API Key
                  <span class="optional">(Claude 3.5 with Brave Search)</span>
                </label>
                <div class="input-with-button">
                  <input
                    type="password"
                    id="anthropic-api-key"
                    placeholder="sk-ant-..."
                    autocomplete="off"
                  />
                  <button class="btn-test" id="test-anthropic">Test</button>
                </div>
                <small class="help-text">
                  Get your API key from
                  <a href="https://console.anthropic.com" target="_blank">
                    console.anthropic.com
                  </a>
                  <br />
                  Note: $10 per 1,000 searches + token costs
                </small>
              </div>
            </div>
          </div>

          <!-- Perplexity Provider -->
          <div class="provider-section">
            <div class="provider-header">
              <label class="provider-toggle">
                <input type="checkbox" id="perplexity-enabled" class="provider-checkbox" />
                <span class="provider-name">Perplexity</span>
              </label>
              <span class="config-status" id="perplexity-status"></span>
            </div>
            <div class="provider-config" id="perplexity-config">
              <div class="form-group">
                <label for="perplexity-api-key">
                  API Key
                  <span class="optional">(Sonar Pro with real-time search)</span>
                </label>
                <div class="input-with-button">
                  <input
                    type="password"
                    id="perplexity-api-key"
                    placeholder="pplx-..."
                    autocomplete="off"
                  />
                  <button class="btn-test" id="test-perplexity">Test</button>
                </div>
                <small class="help-text">
                  Get your API key from
                  <a href="https://www.perplexity.ai/settings/api" target="_blank">
                    perplexity.ai/settings/api
                  </a>
                  <br />
                  Note: Leading SimpleQA benchmark (F-score: 0.858)
                </small>
              </div>
            </div>
          </div>

          <h3>General Settings</h3>

          <div class="form-group checkbox">
            <label>
              <input type="checkbox" id="auto-check" checked />
              <span>Automatically check posts while scrolling</span>
            </label>
          </div>

          <div class="form-group">
            <label for="confidence-threshold">
              Confidence Threshold: <span id="threshold-value">70</span>%
            </label>
            <input
              type="range"
              id="confidence-threshold"
              min="0"
              max="100"
              value="70"
              step="5"
            />
            <small class="help-text">
              Only show results with confidence above this threshold
            </small>
          </div>

          <button id="save-settings" class="btn-primary">Save Settings</button>
          <div id="save-feedback" class="feedback-message"></div>
        </section>

        <section class="advanced-section">
          <details class="advanced-details">
            <summary>
              <h3>Advanced Settings</h3>
            </summary>

            <div class="advanced-content">
              <div class="subsection">
                <h4>Cache Management</h4>
                <p class="help-text">Cached results avoid redundant API calls for identical posts.</p>

                <div class="stats">
                  <div class="stat-item">
                    <span class="stat-label">Cached Results:</span>
                    <span class="stat-value" id="cache-entries">-</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Storage Used:</span>
                    <span class="stat-value" id="cache-storage">-</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Average Age:</span>
                    <span class="stat-value" id="cache-age">-</span>
                  </div>
                </div>

                <button id="clear-cache-btn" class="btn-secondary">Clear Cache</button>
                <div id="cache-feedback" class="feedback-message"></div>
              </div>

              <div class="subsection">
                <h4>Domain Selectors</h4>
                <p class="help-text">Manage CSS selectors for post detection on different platforms.</p>

                <div class="stats">
                  <div class="stat-item">
                    <span class="stat-label">Configured Domains:</span>
                    <span class="stat-value" id="selector-domains">-</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Storage Used:</span>
                    <span class="stat-value" id="selector-storage">-</span>
                  </div>
                </div>

                <div id="selector-list" class="selector-list"></div>

                <button id="add-domain-btn" class="btn-secondary">+ Add Domain</button>
                <div id="selector-feedback" class="feedback-message"></div>
              </div>
            </div>
          </details>
        </section>
      </main>

      <footer>
        <p>Fact-It v0.2.0 | Multi-Provider</p>
      </footer>
    </div>

    <script type="module" src="popup.ts"></script>
  </body>
</html>
